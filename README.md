<p align="center">
  <img src="https://raw.githubusercontent.com/ajgrande924/sandbox-operator/master/assets/logo_readme.png" alt="Logo" width="100" height="100" />
</p>
<h2 align="center">@ajdev/sandbox-operator</h2>
<p align="center">
  <a href="https://goreportcard.com/report/github.com/ajgrande924/sandbox-operator"><img alt="Go Report Card" src="https://goreportcard.com/badge/github.com/ajgrande924/sandbox-operator" height="20"/></a>
  <a href="https://github.com/ajgrande924/sandbox-operator/graphs/contributors"><img alt="Contributors" src="https://img.shields.io/github/contributors/ajgrande924/sandbox-operator.svg" height="20"/></a>
  <a href="https://github.com/ajgrande924/sandbox-operator/graphs/commit-activity"><img alt="Maintained" src="https://img.shields.io/badge/Maintained%3F-yes-green.svg" height="20"/></a>
  <a href="https://opensource.org/licenses/MIT"><img alt="Maintained" src="http://img.shields.io/:license-MIT-yellow.svg" height="20"/></a>
</p>

## Table of Contents

* [Overview](#overview)
* [Development](#development)
* [References](#references)
* [License](#license)

## Overview

The purpose of this project is to provide a reference kubernetes operator generated by `operator-sdk`. The latest kubernetes operator is generated by `operator-sdk@1.0.1`

## Development

* Instantiate project with `operator-sdk`:
```sh
# init project: all API groups will be <group>.ajdev.com
operator-sdk init --domain=ajdev.com --repo=github.com/ajgrande924/sandbox-operator

# create memcached api
operator-sdk create api --group cache --version v1 --kind Memcached --resource=true --controller=true
```

* Update api and controller then update config assets:
```sh
# update generated code
make generate

# update manifests
make manifests
```

* Build operator controller image:
```sh
# build / push operator controller image
make docker-build docker-push IMG=docker.io/ajgrande924/sandbox-operator:1.0.1
```

* Install crd and controller to cluster:
```sh
make install
make deploy IMG=docker.io/ajgrande924/sandbox-operator:1.0.1
```

* Apply custom resource and check:
```sh
kubectl apply -f config/samples/cache_v1_memcached.yaml 
kubectl logs deployment.apps/sandbox-operator-controller-manager -n default -c manager
```

* Cleanup cluster:
```sh
kubectl delete -f config/samples/cache_v1_memcached.yaml
kubectl delete deployments,service -l control-plane=controller-manager
kubectl delete role,rolebinding --all
```

* Build olm bundle:
```sh
make bundle
make bundle-build BUNDLE_IMG=docker.io/ajgrande924/sandbox-operator-bundle:1.0.1
make docker-push IMG=docker.io/ajgrande924/sandbox-operator-bundle:1.0.1
```

## References

* [Operator SDK](https://sdk.operatorframework.io/docs/)
* [Operator Lifecycle Manager](https://olm.operatorframework.io/docs/)

## License

Sandbox Operator is under MIT license. See the [LICENSE](LICENSE) file for details.
